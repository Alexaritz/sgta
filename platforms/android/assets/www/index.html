<!DOCTYPE html> 
<html>
<!--<head>
  <meta charset="UTF-8">
  <title>Validacion de usuarios</title>
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
  <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
</head>-->

<head>
<!-- Include meta tag to ensure proper rendering and touch zooming -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Login</title>
<!-- Include jQuery Mobile stylesheets -->
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<!-- Include the jQuery library -->
<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<!-- Include the jQuery Mobile library -->
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
</head>
<body> 

<div data-role="page" id="hasiera">

	<div data-role="header">
		<h1>Login</h1>
	</div>
    
	<div data-role="content">	
		<form id="form" >
      
      			<label> Erabiltzailea: </label>
      			<input type="text" id="username" name="username">
      
      			<label> Pasahitza: </label>
     			<input type="password" id="password" name="password" >
				
      			<input type="submit" value="Login" id="Login">
      
    		</form>		
	</div>
	 
</div>
 
<div data-role="page" id="menu">

	<div data-role="header">
		<h1>Bienvenido</h1>
	</div>

	<div data-role="content">	
		<h2> Bienvenido a la aplicacion </h2>
		<h3> Su usuario y password son v√°lidos</h3>
	</div>

</div>

<script>
$('#form').submit(function() { 
	
	 
	// recolecta los valores que inserto el usuario
	var user = $("#username").val()
	var pass = $("#password").val()
	window.localStorage.setItem('username',user);
  	loginfitx = "http://sgta.esy.es/login.php?jsoncallback=?"
	$.getJSON( loginfitx, { usuario:user ,password:pass})
	.done(function(loginerantzuna) {
		
		alert(loginerantzuna.mensaje + "\nGenerado en: " + loginerantzuna.hora + "\n" +loginerantzuna.generador)
		
		if(loginerantzuna.validacion == "ok"){
		  
		 	/// si la validacion es correcta, muestra la pantalla "home"
			$.mobile.changePage("menu.html")
		  
		}else{
		  
		  /// ejecutar una conducta cuando la validacion falla
		}
  
	})
	return false;
})
	
</script>

</body>
</html>